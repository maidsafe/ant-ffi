jdk:
  - openjdk17

before_install:
  # Install Rust
  - curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
  - source $HOME/.cargo/env
  # Add Android targets
  - rustup target add aarch64-linux-android armv7-linux-androideabi i686-linux-android x86_64-linux-android
  # Install cargo-ndk
  - cargo install cargo-ndk
  # Install NDK (sdkmanager requires Java 8 due to removed JAXB in Java 11+)
  - sdk install java 8.0.265-open
  - sdk use java 8.0.265-open
  - yes | sdkmanager --licenses
  - yes | sdkmanager --install "ndk;26.2.11394342"
  - sdk install java 17.0.3-tem
  - sdk use java 17.0.3-tem
  # Create local.properties for Android SDK location
  - echo "sdk.dir=$ANDROID_HOME" > android/local.properties

install:
  - cd android && ./gradlew :core:publishToMavenLocal -PVERSION_NAME=$VERSION

env:
  ANDROID_NDK_HOME: "/opt/android-sdk-linux/ndk/26.2.11394342"
