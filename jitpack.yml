jdk:
  - openjdk17

before_install:
  # Install Rust
  - curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
  - source $HOME/.cargo/env
  # Add Android targets
  - rustup target add aarch64-linux-android armv7-linux-androideabi i686-linux-android x86_64-linux-android
  # Install cargo-ndk
  - cargo install cargo-ndk
  # Install NDK
  - yes | sdkmanager --licenses
  - yes | sdkmanager --install "ndk;26.2.11394342"

install:
  - touch android/local.properties
  # Debug: show what NDK versions are available
  - ls -la /opt/android-sdk-linux/ndk/ || echo "No /opt/android-sdk-linux/ndk/"
  - ls -la $ANDROID_HOME/ndk/ || echo "No ANDROID_HOME/ndk/"
  - echo "ANDROID_HOME=$ANDROID_HOME"
  - echo "ANDROID_NDK_HOME=$ANDROID_NDK_HOME"
  - cd android && ./gradlew :core:publishToMavenLocal -PVERSION_NAME=$VERSION

env:
  ANDROID_NDK_HOME: "/opt/android-sdk-linux/ndk/26.2.11394342"
